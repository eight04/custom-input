var customInput=function(){"use strict";function e(e,t,n){for(var r=0,o=e.toUpperCase(),i=n.toUpperCase();o[t+r]&&o[t+r]==i[r];)r++;return e.substr(t,r)}function t(e,t){var n=(e=e.substring(t)).match(/^\d+/);return n&&n[0]}function n(e,t,n){var o=r(e,t,n);return o.err&&"static"!=t.type&&e.startsWith(t.placeholder,n)&&(o.err>1||o.viewValue.length<=t.placeholder.length)?{empty:!0,viewValue:t.placeholder}:o}function r(n,r,o){var i,s,a,l;if("static"==r.type)return n.startsWith(r.value,o)?{viewValue:r.value}:{err:2,code:"TEXT_MISMATCH",message:"Pattern value mismatch"};if("number"==r.type)return null==(a=t(n,o))?{err:1,code:"NUMBER_MISMATCH",message:"Invalid number",viewValue:""}:a.length<r.minLength?{err:1,code:"NUMBER_TOOSHORT",message:"The length of number is too short",value:+a,viewValue:a,properValue:k(+a,r.minLength,r.maxLength)}:(a.length>r.maxLength&&(a=a.substr(0,r.maxLength)),+a<r.min?{err:1,code:"NUMBER_TOOSMALL",message:"The number is too small",value:+a,viewValue:a,properValue:k(r.min,r.minLength,r.maxLength)}:a.length>r.minLength&&"0"==a[0]?{err:1,code:"LEADING_ZERO",message:"The number has too many leading zero",value:+a,viewValue:a,properValue:k(+a,r.minLength,r.maxLength)}:+a>r.max?{err:1,code:"NUMBER_TOOLARGE",message:"The number is too large",value:+a,viewValue:a,properValue:k(r.max,r.minLength,r.maxLength)}:{value:+a,viewValue:a});if("select"==r.type){for(s="",l=0;l<r.select.length;l++)(i=e(n,o,r.select[l]))&&i.length>s.length&&(a=l,s=i);return s?s!=r.select[a]?{err:1,code:"SELECT_INCOMPLETE",message:"Incomplete select",value:a+1,viewValue:s,selected:r.select[a]}:{value:a+1,viewValue:s}:{err:1,code:"SELECT_MISMATCH",message:"Invalid select",viewValue:""}}throw"Unknown token type: "+r.type}function o(e,t){for(var r,o,i=0,s=[],a=e,l=Array.isArray(a),u=0,a=l?a:a[Symbol.iterator]();;){if(l){if(u>=a.length)break;r=a[u++]}else{if((u=a.next()).done)break;r=u.value}if(o=n(t,r.token,i),o.node=r,o.pos=i,o.token=r.token,o.err>=2)throw o.text=t,o;i+=o.viewValue.length,s.push(o)}var h=s[s.length-1];if(h.pos+h.viewValue.length<t.length)throw{code:"TEXT_TOOLONG",message:"Text is too long",text:t};return s}function i(e,t){if("static"==t.type)return{viewValue:t.value};var n=t.extract(e);if("number"==t.type)return{value:n,viewValue:k(n,t.minLength,t.maxLength)};if("select"==t.type)return{value:n,viewValue:t.select[n-1]};throw"Unknown type to format: "+t.type}function s(e,t,n){for(var r,o,s=[],a=t,l=Array.isArray(a),u=0,a=l?a:a[Symbol.iterator]();;){if(l){if(u>=a.length)break;o=a[u++]}else{if((u=a.next()).done)break;o=u.value}r=i(e,o.token),"static"!=o.token.type&&o.empty&&!n&&(r.value=null,r.viewValue=o.token.placeholder),s.push(r)}return s}function a(e,t,n,r){return"object"==(void 0===e?"undefined":v(e))?(t.add(e,n,r),e):t.add(e,n,r)}function l(e,t,n,r){return"object"==(void 0===e?"undefined":v(e))?(t.restore(e,n,r),e):t.restore(e,n,r)}function u(e,t){for(var n,r,o,i=[],s=t,a=Array.isArray(s),l=0,s=a?s:s[Symbol.iterator]();;){if(a){if(l>=s.length)break;n=s[l++]}else{if((l=s.next()).done)break;n=l.value}i.push(new w(e,n))}for(r=0;r<i.length;r++)i[r].next=i[r+1]||null,i[r].prev=i[r-1]||null;for(o=null,r=0;r<i.length;r++)i[r].prevEdit=o,"static"!=i[r].token.type&&(o=i[r]);for(o=null,r=i.length-1;r>=0;r--)i[r].nextEdit=o,"static"!=i[r].token.type&&(o=i[r]);return i}function h(e){return e}function f(e){for(var t=new Map,n=e,r=Array.isArray(n),o=0,n=r?n:n[Symbol.iterator]();;){var i;if(r){if(o>=n.length)break;i=n[o++]}else{if((o=n.next()).done)break;i=o.value}var s=i,a=t.get(s.token.name);a||(a=[],t.set(s.token.name,a)),a.push(s)}return t}function p(e,t){if(t.length){var n=c(t,e).map(function(e){return e.node}),r=n[0],o=n[1];return r==o?r:e-r.offset-r.viewValue.length<=o.offset-e?r:o}}function c(e,t){for(var n,r,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,s=e,a=Array.isArray(s),l=0,s=a?s:s[Symbol.iterator]();;){if(a){if(l>=s.length)break;n=s[l++]}else{if((l=s.next()).done)break;n=l.value}n.offset<=t&&(r={node:n,pos:t-n.offset}),n.offset+n.viewValue.length>=i&&!o&&(o={node:n,pos:i-n.offset})}if(!o){var u=e[e.length-1];o={node:u,pos:u.viewValue.length}}return r||(r={node:e[0],pos:0}),r.pos>r.node.viewValue.length&&(r.pos=r.node.viewValue.length),[r,o]}var d={num2str:function(e,t,n){var r;if((e=""+e).length>n)e=e.substr(e.length-n);else if(e.length<t)for(r=e.length;r<t;r++)e="0"+e;return e},Emitter:function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){function t(){if(!(this instanceof t))return new t}!function(t){function n(e){for(var t in s)e[t]=s[t];return e}function r(e,t){var n,s=this;if(arguments.length){if(t){if(n=o(s,e,!0)){if(!(n=n.filter(function(e){return e!==t&&e.originalListener!==t})).length)return r.call(s,e);s[i][e]=n}}else if((n=s[i])&&(delete n[e],!Object.keys(n).length))return r.call(s)}else delete s[i];return s}function o(e,t,n){if(!n||e[i]){var r=e[i]||(e[i]={});return r[t]||(r[t]=[])}}e.exports=t;var i="listeners",s={on:function(e,t){return o(this,e).push(t),this},once:function(e,t){function n(){r.call(i,e,n),t.apply(this,arguments)}var i=this;return n.originalListener=t,o(i,e).push(n),i},off:r,emit:function(e,t){var n=this,r=o(n,e,!0);if(!r)return!1;var i=arguments.length;if(1===i)r.forEach(function(e){e.call(n)});else if(2===i)r.forEach(function(e){e.call(n,t)});else{var s=Array.prototype.slice.call(arguments,1);r.forEach(function(e){e.apply(n,s)})}return!!r.length}};n(t.prototype),t.mixin=n}(t)})},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=(function(){function e(e){this.value=e}function t(t){function n(o,i){try{var s=t[o](i),a=s.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(s.done?"return":"normal",s.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(e,t){return new Promise(function(r,s){var a={key:e,arg:t,resolve:r,reject:s,next:null};i?i=i.next=a:(o=i=a,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),g=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},m=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},k=d.num2str,x=d.Emitter,w=function(){function e(t,n){y(this,e),this.parser=t,this.token=n,this.value=null,this.viewValue=n.value,this.offset=0,this.next=null,this.prev=null,this.nextEdit=null,this.prevEdit=null,this.empty=!0}return e.prototype.unset=function(){"static"==this.token.type||this.parser.noEmpty||(this.empty=!0,this.parser.setValue(this.parser.value,!1))},e.prototype.parse=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n(e,this.token,t);if(r.err)throw r.node=this,r.token=this.token,r;if(this.parser.noEmpty&&r.empty)throw{code:"NOT_INIT_FORBIDDEN",message:"Empty node is forbidden",node:this};if(r.empty)this.unset();else{this.empty=!1;var o=l(this.parser.copyValue(this.parser.value),this.token,r.value,this.parser);this.parser.setValue(o,!1)}},e.prototype.add=function(e){var t,n=this.parser.copyValue(this.parser.value);this.empty=!1,n=a(n,this.token,e,this.parser),t=this.token.extract(n);var r,o;"number"==this.token.type?(r=this.token.min,o=this.token.max):"select"==this.token.type&&(r=1,o=this.token.select.length),t<r&&(n=l(n,this.token,r,this.parser)),t>o&&(n=l(n,this.token,o,this.parser)),this.parser.setValue(n,!1)},e}(),b={TextParser:function(e){function t(){y(this,t);var n=m(this,e.call(this));return n._constructor.apply(n,arguments),n.initialize(),n}return g(t,e),t.prototype._constructor=function(e){var t=e.tokens,n=e.noEmpty,r=void 0!==n&&n,o=e.value,i=e.text,s=e.copyValue,a=void 0===s?h:s;if(!t||!t.length)throw new Error("option.tokens is required");this.tokens=t,this.nodes=u(this,t),this.nameMap=f(this.nodes),this.value=o,this.text=i,this.noEmpty=r,this.copyValue=a,this.err=!1},t.prototype.initialize=function(){this.setValue(this.value)},t.prototype.parse=function(e){if(!e)throw{code:"EMPTY",message:"The input is empty",oldText:this.text};var t,n;t=o(this.nodes,e);var r,i=[];for(r=this.err?o(this.nodes,this.text):this.nodes,n=0;n<t.length;n++)t[n].empty||t[n].viewValue==r[n].viewValue||(t[n].token=this.nodes[n].token,i.push(t[n]));var a=t.filter(function(e){return e.empty}),u=t.filter(function(e){return e.err});for(n=0;n<t.length;n++)this.nodes[n].value=t[n].value,this.nodes[n].viewValue=t[n].viewValue,this.nodes[n].offset=t[n].pos,this.nodes[n].empty=t[n].empty;if(u.length)throw this.err=!0,u[0];this.err=!1,i.sort(function(e,t){return t.empty?-1:e.empty?1:(t.token.prior||0)-(e.token.prior||0)});for(var h,f=this.copyValue(this.value),p=i,c=Array.isArray(p),d=0,p=c?p:p[Symbol.iterator]();;){if(c){if(d>=p.length)break;h=p[d++]}else{if((d=p.next()).done)break;h=d.value}f=l(f,h.token,h.value,this)}var v=s(f,t).map(function(e){return e.viewValue}).join("");if(e!=v)throw this.err=!0,{code:"INCONSISTENT_INPUT",message:"Successfully parsed but the output text doesn't match the input",text:e,oldText:this.text,properText:v};if(this.text=e,this.value=f,this.emit("change",this.value),a.length)throw{code:"NOT_INIT",message:"Some nodes are empty",text:e,node:a[0]};return this},t.prototype.setValue=function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=s(e,this.nodes,n),o=0,i="";for(t=0;t<r.length;t++)this.nodes[t].value=r[t].value,this.nodes[t].viewValue=r[t].viewValue,this.nodes[t].offset=o,this.nodes[t].empty=!n&&this.nodes[t].empty,o+=this.nodes[t].viewValue.length,i+=this.nodes[t].viewValue;return this.value=e,this.text=i,this.emit("change",this.value),this},t.prototype.isEmpty=function(e){var t;if(e)try{t=o(this.nodes,e)}catch(e){return!1}else t=this.nodes;var n;for(n=0;n<t.length;n++)if("static"!=this.nodes[n].token.type&&!t[n].empty)return!1;return!0},t.prototype.isInit=function(){for(var e,t=this.nodes,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}if("static"!=e.token.type&&e.empty)return!1}return!0},t.prototype.unset=function(){for(var e,t=this.nodes,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}e.empty=!0}return this.setValue(this.value,!1),this},t.prototype.getText=function(){return this.text},t.prototype.getValue=function(){return this.value},t.prototype.getNodes=function(e){return e?this.nameMap.get(e):this.nodes},t}(x)},E=d.Emitter,T=function(){function e(t,n){y(this,e),this.el=t,this.nodes=n,this.range={node:p(0,this.nodes),start:0,end:"end"}}return e.prototype.selectNearestNode=function(){var e=this.el.getSelection();e&&this.select({node:p(e.start,this.nodes),start:0,end:"end"})},e.prototype.select=function(e){(e=Object.assign(this.range,e)).node&&this.el.setSelection(e.node.offset+e.start,e.node.offset+("end"==e.end?e.node.viewValue.length:e.end))},e.prototype.hasNext=function(){if(this.range.node)return this.range.node.nextEdit},e.prototype.hasPrev=function(){if(this.range.node)return this.range.node.prevEdit},e.prototype.selectNext=function(){var e=this.hasNext(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},e.prototype.selectPrev=function(){var e=this.hasPrev(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},e.prototype.get=function(){if(this.nodes.length){var e=this.el.getSelection();if(e){var t=c(this.nodes,e.start,e.end),n=t[0],r=t[1];n.node==r.node&&(this.range={node:n.node,start:n.pos,end:r.pos})}}},e.prototype.atNodeEnd=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t=this.range.node.token.maxLength,n="end"==this.range.start?e:this.range.start;return n==("end"==this.range.end?e:this.range.end)&&n==(null!=t?t:e)||!e}},e.prototype.atNodeStart=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t="end"==this.range.start?e:this.range.start;return t==("end"==this.range.end?e:this.range.end)&&0==t}},e}(),V={InputMask:function(e){function t(){y(this,t);var n=m(this,e.call(this));return n._constructor.apply(n,arguments),n.initialize(),n}return g(t,e),t.prototype._constructor=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.el=e,this.tp=t,this.separators=n,this.sel=new T(e,t.getNodes().filter(function(e){return"static"!=e.token.type}))},t.prototype.initialize=function(){var e=this;this.el.on("mousedown",function(){e.mousedown=!0}),this.el.on("focus",function(){e.mousedown||setTimeout(function(){e.sel.select({start:0,end:"end"})})}),this.el.on("click",function(){e.mousedown=!1,e.sel.selectNearestNode()}),this.el.on("input",function(){e.digest(null,e.el.val())}),this.el.on("keydown",function(t){t.altKey||t.ctrlKey||(37==t.keyCode||9==t.keyCode&&t.shiftKey&&e.sel.hasPrev()?(t.preventDefault(),e.tryFixingError(),e.sel.selectPrev()):39==t.keyCode||9==t.keyCode&&!t.shiftKey&&e.sel.hasNext()?(t.preventDefault(),e.tryFixingError(),e.sel.selectNext()):38==t.keyCode?(t.preventDefault(),e.sel.selectNearestNode(),e.sel.range.node&&e.sel.range.node.add(1),e.val(e.tp.getText()),e.sel.select({start:0,end:"end"})):40==t.keyCode?(t.preventDefault(),e.sel.selectNearestNode(),e.sel.range.node&&e.sel.range.node.add(-1),e.val(e.tp.getText()),e.sel.select({start:0,end:"end"})):36==t.keyCode||35==t.keyCode?setTimeout(function(){return e.sel.selectNearestNode()}):46==t.keyCode?e.sel.atNodeEnd()&&(t.preventDefault(),e.tryFixingError(),e.sel.selectNext()):8==t.keyCode&&e.sel.atNodeStart()&&(t.preventDefault(),e.tryFixingError(),e.sel.selectPrev()))}),this.el.on("keypress",function(t){var n=null==t.charCode?t.keyCode:t.charCode,r=String.fromCharCode(n),o=e.separators,i=e.sel.range.node;if(i&&i.next&&"static"==i.next.token.type&&(o+=i.next.viewValue[0]),o.includes(r))return t.preventDefault(),e.tryFixingError(),void e.sel.selectNext();setTimeout(function(){e.sel.atNodeEnd()&&e.sel.range.node.viewValue&&(e.tryFixingError(),e.sel.selectNext())})}),this.el.on("blur",function(){setTimeout(function(){e.tryFixingError()})}),this.tp.on("change",function(){e.err||e.inDigest||(e.val(e.tp.getText()),e.sel.select())});var t=this.el.val();t?this.digest(null,t,!0):this.val(this.tp.getText())},t.prototype.errorViewLength=function(){if(this.err&&null!=this.err.viewValue)return this.err.viewValue.length},t.prototype.val=function(e){this.el.val()!=e&&this.el.val(e),this.err=null},t.prototype.tryFixingError=function(){this.err&&(this.err.properValue?this.digest(this.err.node,this.err.properValue,!0):this.err.node&&(this.err.node.unset(),this.digest(null,this.tp.getText())))},t.prototype.digest=function(e,t,n){var r,o=10;for(this.inDigest=!0;o--;){this.err=null;try{e?e.parse(t):this.tp.parse(t)}catch(o){if(this.emit("digest",o),this.sel.get(),"NOT_INIT"==o.code)break;if(this.err=o,!n&&("NUMBER_TOOSHORT"==o.code||"NUMBER_TOOSMALL"==o.code||"NUMBER_MISMATCH"==o.code||"SELECT_MISMATCH"==o.code||"LEADING_ZERO"==o.code))break;if("SELECT_INCOMPLETE"==o.code){e=o.node,t=o.selected,r={end:"end"};continue}null!=o.properValue?(e=o.node,t=o.properValue):null!=o.properText?(e=null,t=o.properText):("EMPTY"==o.code&&this.tp.unset(),o.node&&o.node.unset(),e=null,t=this.tp.getText(),r={start:0,end:"end"});continue}break}if(this.err||(this.val(this.tp.getText()),o<9&&this.sel.select(r)),this.inDigest=!1,o<0)throw new Error("InputMask.digest crashed! Infinite loop on "+t)},t}(E)};return{TextParser:b.TextParser,InputMask:V.InputMask,utils:d}}();
