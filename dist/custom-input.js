var customInput=function(e){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){var r;if((e=""+e).length>n)e=e.substr(e.length-n);else if(e.length<t)for(r=e.length;r<t;r++)e="0"+e;return e}var t=Object.freeze({num2str:u});var a={exports:{}};!function(e){void 0!==a&&(a.exports=e);var s="listeners",n={on:function r(e,t){return u(this,e).push(t),this},once:function i(e,t){var n=this;return r.originalListener=t,u(n,e).push(r),n;function r(){o.call(n,e,r),t.apply(this,arguments)}},off:o,emit:function h(e,t){var n=this,r=u(n,e,!0);if(!r)return!1;var i=arguments.length;if(1===i)r.forEach(function o(e){e.call(n)});else if(2===i)r.forEach(function a(e){e.call(n,t)});else{var s=Array.prototype.slice.call(arguments,1);r.forEach(function l(e){e.apply(n,s)})}return!!r.length}};function t(e){for(var t in n)e[t]=n[t];return e}function o(e,t){var n,r=this;if(arguments.length){if(t){if(n=u(r,e,!0)){if(!(n=n.filter(function i(e){return e!==t&&e.originalListener!==t})).length)return o.call(r,e);r[s][e]=n}}else if((n=r[s])&&(delete n[e],!Object.keys(n).length))return o.call(r)}else delete r[s];return r}function u(e,t,n){if(!n||e[s]){var r=e[s]||(e[s]={});return r[t]||(r[t]=[])}}t(e.prototype),e.mixin=t}(function w(){if(!(this instanceof w))return new w});var n=a.exports;function h(e,t,n){for(var r=0,i=e.toUpperCase(),s=n.toUpperCase();i[t+r]&&i[t+r]==s[r];)r++;return e.substr(t,r)}function d(e,t,n){var r=function l(e,t,n){var r,i,s,o;if("static"==t.type)return e.startsWith(t.value,n)?{viewValue:t.value}:{err:2,code:"TEXT_MISMATCH",message:"Pattern value mismatch"};if("number"==t.type)return null==(s=function a(e,t){var n=(e=e.substring(t)).match(/^\d+/);return n&&n[0]}(e,n))?{err:1,code:"NUMBER_MISMATCH",message:"Invalid number",viewValue:""}:s.length<t.minLength?{err:1,code:"NUMBER_TOOSHORT",message:"The length of number is too short",value:+s,viewValue:s,properValue:u(+s,t.minLength,t.maxLength)}:(s.length>t.maxLength&&(s=s.substr(0,t.maxLength)),+s<t.min?{err:1,code:"NUMBER_TOOSMALL",message:"The number is too small",value:+s,viewValue:s,properValue:u(t.min,t.minLength,t.maxLength)}:s.length>t.minLength&&"0"==s[0]?{err:1,code:"LEADING_ZERO",message:"The number has too many leading zero",value:+s,viewValue:s,properValue:u(+s,t.minLength,t.maxLength)}:+s>t.max?{err:1,code:"NUMBER_TOOLARGE",message:"The number is too large",value:+s,viewValue:s,properValue:u(t.max,t.minLength,t.maxLength)}:{value:+s,viewValue:s});if("select"!=t.type)throw"Unknown token type: "+t.type;for(i="",o=0;o<t.select.length;o++)(r=h(e,n,t.select[o]))&&r.length>i.length&&(s=o,i=r);return i?i==t.select[s]?{value:s+1,viewValue:i}:{err:1,code:"SELECT_INCOMPLETE",message:"Incomplete select",value:s+1,viewValue:i,selected:t.select[s]}:{err:1,code:"SELECT_MISMATCH",message:"Invalid select",viewValue:""}}(e,t,n);return r.err&&"static"!=t.type&&e.startsWith(t.placeholder,n)&&(1<r.err||r.viewValue.length<=t.placeholder.length)?{empty:!0,viewValue:t.placeholder}:r}function c(e,t){var n,r,i=0,s=[],o=e,a=Array.isArray(o),l=0;for(o=a?o:o[Symbol.iterator]();;){if(a){if(l>=o.length)break;n=o[l++]}else{if((l=o.next()).done)break;n=l.value}if((r=d(t,n.token,i)).node=n,r.pos=i,r.token=n.token,2<=r.err)throw r.text=t,r;i+=r.viewValue.length,s.push(r)}var u=s[s.length-1];if(u.pos+u.viewValue.length<t.length)throw{code:"TEXT_TOOLONG",message:"Text is too long",text:t};return s}function f(e,t){if("static"==t.type)return{viewValue:t.value};var n=t.extract(e);if("number"==t.type)return{value:n,viewValue:u(n,t.minLength,t.maxLength)};if("select"==t.type)return{value:n,viewValue:t.select[n-1]};throw"Unknown type to format: "+t.type}function p(e,t,n){var r,i,s=[],o=t,a=Array.isArray(o),l=0;for(o=a?o:o[Symbol.iterator]();;){if(a){if(l>=o.length)break;i=o[l++]}else{if((l=o.next()).done)break;i=l.value}r=f(e,i.token),"static"!=i.token.type&&i.empty&&!n&&(r.value=null,r.viewValue=i.token.placeholder),s.push(r)}return s}var v=function(){function e(e,t){this.parser=e,this.token=t,this.value=null,this.viewValue=t.value,this.offset=0,this.next=null,this.prev=null,this.nextEdit=null,this.prevEdit=null,this.empty=!0}var t=e.prototype;return t.unset=function(){"static"==this.token.type||this.parser.noEmpty||(this.empty=!0,this.parser.setValue(this.parser.value,!1))},t.parse=function(e,t){void 0===t&&(t=0);var n=d(e,this.token,t);if(n.err)throw n.node=this,n.token=this.token,n;if(this.parser.noEmpty&&n.empty)throw{code:"NOT_INIT_FORBIDDEN",message:"Empty node is forbidden",node:this};if(n.empty)this.unset();else{this.empty=!1;var r=g(this.parser.copyValue(this.parser.value),this.token,n.value,this.parser);this.parser.setValue(r,!1)}},t.add=function(e){var t,n,r,i=this.parser.copyValue(this.parser.value);this.empty=!1,i=function s(e,t,n,r){return"object"==typeof e?(t.add(e,n,r),e):t.add(e,n,r)}(i,this.token,e,this.parser),t=this.token.extract(i),"number"==this.token.type?(n=this.token.min,r=this.token.max):"select"==this.token.type&&(n=1,r=this.token.select.length),t<n&&(i=g(i,this.token,n,this.parser)),r<t&&(i=g(i,this.token,r,this.parser)),this.parser.setValue(i,!1)},e}();function g(e,t,n,r){return"object"==typeof e?(t.restore(e,n,r),e):t.restore(e,n,r)}function y(e){return e}var s=function(t){function e(){var e;return(e=t.call(this)||this)._constructor.apply(i(e),arguments),e.initialize(),e}r(e,t);var n=e.prototype;return n._constructor=function(e){var t=e.tokens,n=e.noEmpty,r=void 0!==n&&n,i=e.value,s=e.text,o=e.copyValue,a=void 0===o?y:o;if(!t||!t.length)throw new Error("option.tokens is required");this.tokens=t,this.nodes=function u(e,t){var n,r,i,s=[],o=t,a=Array.isArray(o),l=0;for(o=a?o:o[Symbol.iterator]();;){if(a){if(l>=o.length)break;n=o[l++]}else{if((l=o.next()).done)break;n=l.value}s.push(new v(e,n))}for(r=0;r<s.length;r++)s[r].next=s[r+1]||null,s[r].prev=s[r-1]||null;for(i=null,r=0;r<s.length;r++)s[r].prevEdit=i,"static"!=s[r].token.type&&(i=s[r]);for(i=null,r=s.length-1;0<=r;r--)s[r].nextEdit=i,"static"!=s[r].token.type&&(i=s[r]);return s}(this,t),this.nameMap=function l(e){var t=new Map,n=e,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var s;if(r){if(i>=n.length)break;s=n[i++]}else{if((i=n.next()).done)break;s=i.value}var o=s,a=t.get(o.token.name);a||(a=[],t.set(o.token.name,a)),a.push(o)}return t}(this.nodes),this.value=i,this.text=s,this.noEmpty=r,this.copyValue=a,this.err=!1},n.initialize=function(){this.setValue(this.value)},n.parse=function(e){if(!e)throw{code:"EMPTY",message:"The input is empty",oldText:this.text};var t,n;t=c(this.nodes,e);var r,i=[];for(r=this.err?c(this.nodes,this.text):this.nodes,n=0;n<t.length;n++)t[n].empty||t[n].viewValue==r[n].viewValue||(t[n].token=this.nodes[n].token,i.push(t[n]));var s=t.filter(function(e){return e.empty}),o=t.filter(function(e){return e.err});for(n=0;n<t.length;n++)this.nodes[n].value=t[n].value,this.nodes[n].viewValue=t[n].viewValue,this.nodes[n].offset=t[n].pos,this.nodes[n].empty=t[n].empty;if(o.length)throw this.err=!0,o[0];this.err=!1,i.sort(function(e,t){return t.empty?-1:e.empty?1:(t.token.prior||0)-(e.token.prior||0)});for(var a,l=this.copyValue(this.value),u=0,h=i;u<h.length;u++)l=g(l,(a=h[u]).token,a.value,this);var d=p(l,t).map(function(e){return e.viewValue}).join("");if(e!=d)throw this.err=!0,{code:"INCONSISTENT_INPUT",message:"Successfully parsed but the output text doesn't match the input",text:e,oldText:this.text,properText:d};if(this.text=e,this.value=l,this.emit("change",this.value),s.length)throw{code:"NOT_INIT",message:"Some nodes are empty",text:e,node:s[0]};return this},n.setValue=function(e,t){void 0===t&&(t=!0);var n,r=p(e,this.nodes,t),i=0,s="";for(n=0;n<r.length;n++)this.nodes[n].value=r[n].value,this.nodes[n].viewValue=r[n].viewValue,this.nodes[n].offset=i,this.nodes[n].empty=!t&&this.nodes[n].empty,i+=this.nodes[n].viewValue.length,s+=this.nodes[n].viewValue;return this.value=e,this.text=s,this.emit("change",this.value),this},n.isEmpty=function(e){var t,n;if(e)try{t=c(this.nodes,e)}catch(r){return!1}else t=this.nodes;for(n=0;n<t.length;n++)if("static"!=this.nodes[n].token.type&&!t[n].empty)return!1;return!0},n.isInit=function(){var e,t=this.nodes,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}if("static"!=e.token.type&&e.empty)return!1}return!0},n.unset=function(){var e,t=this.nodes,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){if(n){if(r>=t.length)break;e=t[r++]}else{if((r=t.next()).done)break;e=r.value}e.empty=!0}return this.setValue(this.value,!1),this},n.getText=function(){return this.text},n.getValue=function(){return this.value},n.getNodes=function(e){return e?this.nameMap.get(e):this.nodes},e}(n);function o(e,t,n){if(e.length){var r=l(e,t,n).map(function(e){return e.node}),i=r[0],s=r[1];return i==s?i:t-i.offset-i.viewValue.length<=s.offset-t?i:s}}function l(n,r,i){var e,t;void 0===i&&(i=r);var s=n.find(function(e,t){return r===i&&e.offset+e.viewValue.length>=r||t+1>=n.length||n[t+1].offset>r});s&&(e={node:s,pos:r-s.offset});var o=n.find(function(e){return e.offset+e.viewValue.length>=i});if(o&&(t={node:o,pos:i-o.offset}),!t){var a=n[n.length-1];t={node:a,pos:a.viewValue.length}}e=e||{node:n[0],pos:0};return e.pos>e.node.viewValue.length&&(e.pos=e.node.viewValue.length),[e,t]}var m=function(){function e(e,t){this.el=e,this.nodes=t,this.range={node:o(this.nodes,0),start:0,end:"end"}}var t=e.prototype;return t.selectNearestNode=function(){var e=this.el.getSelection();e&&this.select({node:o(this.nodes,e.start,e.end),start:0,end:"end"})},t.select=function(e){(e=Object.assign(this.range,e)).node&&this.el.setSelection(e.node.offset+e.start,e.node.offset+("end"==e.end?e.node.viewValue.length:e.end))},t.hasNext=function(){if(this.range.node)return this.range.node.nextEdit},t.hasPrev=function(){if(this.range.node)return this.range.node.prevEdit},t.selectNext=function(){var e=this.hasNext(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},t.selectPrev=function(){var e=this.hasPrev(),t={start:0,end:"end"};e&&(t.node=e),this.select(t)},t.get=function(){if(this.nodes.length){var e=this.el.getSelection();if(e){var t=l(this.nodes,e.start,e.end),n=t[0],r=t[1];n.node==r.node&&(this.range={node:n.node,start:n.pos,end:r.pos})}}},t.atNodeEnd=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t=this.range.node.token.maxLength,n="end"==this.range.start?e:this.range.start;return n==("end"==this.range.end?e:this.range.end)&&n==(null!=t?t:e)||!e}},t.atNodeStart=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t="end"==this.range.start?e:this.range.start;return t==("end"==this.range.end?e:this.range.end)&&0==t}},t.matchEntireNode=function(){if(this.range.node){this.get();var e=this.range.node.viewValue.length,t="end"===this.range.start?e:this.range.start,n="end"===this.range.end?e:this.range.end;return 0===t&&n===e}},e}(),x=s,k=function(t){function e(){var e;return(e=t.call(this)||this)._constructor.apply(i(e),arguments),e.initialize(),e}r(e,t);var n=e.prototype;return n._constructor=function(e,t,n){void 0===n&&(n=""),this.el=e,this.tp=t,this.separators=n,this.sel=new m(e,t.getNodes().filter(function(e){return"static"!=e.token.type}))},n.initialize=function(){var s=this;this.el.on("mousedown",function(){s.mousedown=!0}),this.el.on("focus",function(){s.mousedown||setTimeout(function(){s.sel.select({start:0,end:"end"})})}),this.el.on("click",function(){s.mousedown=!1,s.sel.selectNearestNode()}),this.el.on("input",function(){s.digest(null,s.el.val())}),this.el.on("keydown",function(e){e.altKey||e.ctrlKey||(37==e.keyCode||9==e.keyCode&&e.shiftKey&&s.sel.hasPrev()?(e.preventDefault(),s.tryFixingError(),s.sel.selectPrev()):39==e.keyCode||9==e.keyCode&&!e.shiftKey&&s.sel.hasNext()?(e.preventDefault(),s.tryFixingError(),s.sel.selectNext()):38==e.keyCode?(e.preventDefault(),s.sel.selectNearestNode(),s.sel.range.node&&s.sel.range.node.add(1),s.val(s.tp.getText()),s.sel.select({start:0,end:"end"})):40==e.keyCode?(e.preventDefault(),s.sel.selectNearestNode(),s.sel.range.node&&s.sel.range.node.add(-1),s.val(s.tp.getText()),s.sel.select({start:0,end:"end"})):36==e.keyCode||35==e.keyCode?setTimeout(function(){return s.sel.selectNearestNode()}):46==e.keyCode?s.sel.atNodeEnd()?(e.preventDefault(),s.tryFixingError(),s.sel.selectNext()):s.sel.matchEntireNode()&&(e.preventDefault(),s.sel.range.node.unset(),s.digest(s.sel.range.node,s.sel.range.node.viewValue)):8==e.keyCode&&(s.sel.atNodeStart()?(e.preventDefault(),s.tryFixingError(),s.sel.selectPrev()):s.sel.matchEntireNode()&&(e.preventDefault(),s.sel.range.node.unset(),s.digest(s.sel.range.node,s.sel.range.node.viewValue))))}),this.el.on("keypress",function(e){var t=null==e.charCode?e.keyCode:e.charCode,n=String.fromCharCode(t),r=s.separators,i=s.sel.range.node;if(i&&i.next&&"static"==i.next.token.type&&(r+=i.next.viewValue[0]),r.includes(n))return e.preventDefault(),s.tryFixingError(),void s.sel.selectNext();setTimeout(function(){s.sel.atNodeEnd()&&s.sel.range.node.viewValue&&(s.tryFixingError(),s.sel.selectNext())})}),this.el.on("blur",function(){setTimeout(function(){s.tryFixingError()})}),this.tp.on("change",function(){s.err||s.inDigest||(s.val(s.tp.getText()),s.sel.select())});var e=this.el.val();e?this.digest(null,e,!0):this.val(this.tp.getText())},n.errorViewLength=function(){return this.err&&null!=this.err.viewValue?this.err.viewValue.length:undefined},n.val=function(e){this.el.val()!=e&&this.el.val(e),this.err=null},n.tryFixingError=function(){this.err&&(this.err.properValue?this.digest(this.err.node,this.err.properValue,!0):this.err.node&&(this.err.node.unset(),this.digest(null,this.tp.getText())))},n.digest=function s(e,t,n){var r,s=10;for(this.inDigest=!0;s--;){this.err=null;try{e?e.parse(t):this.tp.parse(t)}catch(i){if(this.emit("digest",i),this.sel.get(),"NOT_INIT"==i.code)break;if(this.err=i,!n&&("NUMBER_TOOSHORT"==i.code||"NUMBER_TOOSMALL"==i.code||"NUMBER_MISMATCH"==i.code||"SELECT_MISMATCH"==i.code||"LEADING_ZERO"==i.code))break;if("SELECT_INCOMPLETE"==i.code){e=i.node,t=i.selected,r={end:"end"};continue}null!=i.properValue?(e=i.node,t=i.properValue):null!=i.properText?(e=null,t=i.properText):("EMPTY"==i.code&&this.tp.unset(),i.node&&i.node.unset(),e=null,t=this.tp.getText(),r={start:0,end:"end"});continue}break}if(this.err||(this.val(this.tp.getText()),s<9&&this.sel.select(r)),this.inDigest=!1,s<0)throw new Error("InputMask.digest crashed! Infinite loop on "+t)},e}(n);return e.InputMask=k,e.TextParser=x,e.utils=t,e}({});
